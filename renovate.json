{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    ":dependencyDashboard",
    ":semanticCommits"
  ],
  "dependencyDashboard": true,
  "dependencyDashboardTitle": "Renovate Dashboard ðŸ¤–",
  "terraform": {
    "fileMatch": [
      "\\.tf$",
      "\\.tofu$",
      "\\.tfvars$"
    ]
  },
  "kubernetes": {
    "fileMatch": [
      "\\.yaml$",
      "\\.yml$"
    ]
  },
  "kustomize": {
    "fileMatch": [
      "(^|/)kustomization\\.ya?ml$"
    ]
  },
  "customManagers": [
    {
      "customType": "regex",
      "description": "Update Talos versions in tfvars files",
      "fileMatch": [
        "\\.tfvars$"
      ],
      "matchStrings": [
        "version\\s*=\\s*\"(?<currentValue>v?[0-9]+\\.[0-9]+\\.[0-9]+)\"",
        "talos_machine_config_version\\s*=\\s*\"(?<currentValue>v?[0-9]+\\.[0-9]+\\.[0-9]+)\""
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "siderolabs/talos"
    },
    {
      "customType": "regex",
      "description": "Update Kubernetes versions in tfvars files",
      "fileMatch": [
        "\\.tfvars$"
      ],
      "matchStrings": [
        "kubernetes_version\\s*=\\s*\"(?<currentValue>v?[0-9]+\\.[0-9]+\\.[0-9]+)\""
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "kubernetes/kubernetes"
    },
    {
      "customType": "regex",
      "description": "Update Gateway API versions in tfvars files",
      "fileMatch": [
        "\\.tfvars$"
      ],
      "matchStrings": [
        "gateway_api_version\\s*=\\s*\"(?<currentValue>v?[0-9]+\\.[0-9]+\\.[0-9]+)\""
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "kubernetes-sigs/gateway-api"
    }
  ],
  "packageRules": [
    {
      "groupName": "Talos System",
      "matchPackageNames": [
        "siderolabs/talos"
      ]
    },
    {
      "groupName": "Kubernetes Core",
      "matchPackageNames": [
        "kubernetes/kubernetes",
        "kubernetes-sigs/gateway-api"
      ]
    },
    {
      "groupName": "Cilium Network",
      "matchPackageNames": [
        "cilium/**"
      ]
    },
    {
      "groupName": "Monitoring Stack", 
      "matchPackageNames": [
        "prometheus-community/**",
        "grafana/**"
      ]
    },
    {
      "groupName": "Storage & Backup",
      "matchPackageNames": [
        "**/longhorn**",
        "**/rook**",
        "**/velero**"
      ]
    },
    {
      "groupName": "ArgoCD",
      "matchPackageNames": [
        "argoproj/**"
      ]
    }
  ]
}