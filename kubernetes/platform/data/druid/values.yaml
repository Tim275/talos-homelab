# Homelab Druid - minimal resources
image:
  tag: "30.0.1"

# PostgreSQL for metadata (use embedded)
postgresql:
  enabled: true
  auth:
    username: druid
    password: druidpass123
    database: druid
  primary:
    persistence:
      storageClass: rook-ceph-block-enterprise
      size: 2Gi

# Zookeeper disabled - use K8s extensions
zookeeper:
  enabled: false

# Storage
configVars:
  druid_storage_type: local
  druid_storage_storageDirectory: /opt/druid/var/druid/segments
  druid_indexer_logs_type: file
  druid_indexer_logs_directory: /opt/druid/var/druid/indexing-logs
  # K8s discovery
  druid_zk_service_enabled: "false"
  druid_discovery_type: k8s
  druid_serverview_type: http
  druid_coordinator_loadqueuepeon_type: http
  druid_indexer_runner_type: httpRemote

# Minimal replicas for homelab
broker:
  replicaCount: 1
  resources:
    requests:
      memory: 512Mi
      cpu: 100m
    limits:
      memory: 1Gi
      cpu: 1000m
  javaOpts: "-Xms256m -Xmx512m -XX:MaxDirectMemorySize=256m"

coordinator:
  replicaCount: 1
  resources:
    requests:
      memory: 256Mi
      cpu: 100m
    limits:
      memory: 512Mi
      cpu: 500m
  javaOpts: "-Xms128m -Xmx256m"

overlord:
  replicaCount: 1
  resources:
    requests:
      memory: 256Mi
      cpu: 100m
    limits:
      memory: 512Mi
      cpu: 500m
  javaOpts: "-Xms128m -Xmx256m"

router:
  replicaCount: 1
  resources:
    requests:
      memory: 128Mi
      cpu: 50m
    limits:
      memory: 256Mi
      cpu: 500m
  javaOpts: "-Xms64m -Xmx128m"

historical:
  replicaCount: 1
  resources:
    requests:
      memory: 512Mi
      cpu: 100m
    limits:
      memory: 1Gi
      cpu: 1000m
  javaOpts: "-Xms256m -Xmx512m -XX:MaxDirectMemorySize=256m"
  persistence:
    enabled: true
    storageClass: rook-ceph-block-enterprise
    size: 10Gi

middleManager:
  replicaCount: 1
  resources:
    requests:
      memory: 128Mi
      cpu: 100m
    limits:
      memory: 256Mi
      cpu: 500m
  javaOpts: "-Xms64m -Xmx128m"
  persistence:
    enabled: true
    storageClass: rook-ceph-block-enterprise
    size: 5Gi
