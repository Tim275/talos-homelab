---
# PodDisruptionBudgets for Druid Components
# Ensures graceful handling during node maintenance/upgrades
# Labels from DataInfra Druid Operator: nodeSpecUniqueStr=druid-druid-<nodetype>
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: druid-coordinators-pdb
  namespace: druid
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      druid_cr: druid
      nodeSpecUniqueStr: druid-druid-coordinators
---
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: druid-brokers-pdb
  namespace: druid
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      druid_cr: druid
      nodeSpecUniqueStr: druid-druid-brokers
---
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: druid-historicals-pdb
  namespace: druid
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      druid_cr: druid
      nodeSpecUniqueStr: druid-druid-historicals
---
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: druid-middlemanagers-pdb
  namespace: druid
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      druid_cr: druid
      nodeSpecUniqueStr: druid-druid-middlemanagers
---
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: druid-routers-pdb
  namespace: druid
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      druid_cr: druid
      nodeSpecUniqueStr: druid-druid-routers
---
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: druid-zookeeper-pdb
  namespace: druid
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app: druid-zookeeper
