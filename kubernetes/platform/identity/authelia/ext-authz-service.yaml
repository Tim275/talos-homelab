# Authelia External Authorization Service
# Used by Envoy Gateway SecurityPolicy for ForwardAuth validation
#
# This service exposes Authelia's ForwardAuth endpoint (/api/authz/forward-auth)
# to the Envoy Gateway for authentication checks.
#
# Flow:
# 1. Envoy Gateway receives request for protected service
# 2. Envoy Gateway calls this service at /api/authz/forward-auth
# 3. Authelia validates session cookie
# 4. Returns 200 OK (authenticated) or 302 Redirect (not authenticated)

apiVersion: v1
kind: Service
metadata:
  name: authelia-ext-authz
  namespace: authelia
  labels:
    app.kubernetes.io/name: authelia
    app.kubernetes.io/component: ext-authz
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 9091
      targetPort: http
      protocol: TCP
  selector:
    app.kubernetes.io/name: authelia
