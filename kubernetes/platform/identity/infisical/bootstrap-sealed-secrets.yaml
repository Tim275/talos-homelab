---
# BOOTSTRAP SECRETS - Layer 1 (Sealed Secrets)
# These secrets bootstrap Infisical itself
# Generate with: kubectl create secret generic <name> --dry-run=client -o yaml | kubeseal -o yaml

# PostgreSQL credentials for Infisical database
apiVersion: v1
kind: Secret
metadata:
  name: infisical-postgres-credentials
  namespace: infisical
type: Opaque
stringData:
  username: infisical
  password: REPLACE_WITH_SEALED_SECRET  # Generate: openssl rand -base64 32

---
# PostgreSQL S3 backup credentials
apiVersion: v1
kind: Secret
metadata:
  name: infisical-postgres-s3
  namespace: infisical
type: Opaque
stringData:
  ACCESS_KEY_ID: REPLACE_WITH_SEALED_SECRET
  SECRET_ACCESS_KEY: REPLACE_WITH_SEALED_SECRET

---
# Redis password
apiVersion: v1
kind: Secret
metadata:
  name: infisical-redis-secret
  namespace: infisical
type: Opaque
stringData:
  password: REPLACE_WITH_SEALED_SECRET  # Generate: openssl rand -base64 32

---
# Infisical encryption key
apiVersion: v1
kind: Secret
metadata:
  name: infisical-encryption-key
  namespace: infisical
type: Opaque
stringData:
  ENCRYPTION_KEY: REPLACE_WITH_SEALED_SECRET  # Generate: openssl rand -hex 16

---
# Infisical JWT secrets
apiVersion: v1
kind: Secret
metadata:
  name: infisical-jwt-secrets
  namespace: infisical
type: Opaque
stringData:
  JWT_AUTH_SECRET: REPLACE_WITH_SEALED_SECRET      # Generate: openssl rand -hex 32
  JWT_REFRESH_SECRET: REPLACE_WITH_SEALED_SECRET   # Generate: openssl rand -hex 32
  JWT_SERVICE_SECRET: REPLACE_WITH_SEALED_SECRET   # Generate: openssl rand -hex 32

---
# INSTRUCTIONS TO SEAL SECRETS:
# 1. Generate random secrets:
#    openssl rand -base64 32  # For passwords
#    openssl rand -hex 16     # For encryption key
#    openssl rand -hex 32     # For JWT secrets
#
# 2. Create unsealed secret:
#    kubectl create secret generic infisical-postgres-credentials \
#      --namespace=infisical \
#      --from-literal=username=infisical \
#      --from-literal=password=<generated-password> \
#      --dry-run=client -o yaml > /tmp/secret.yaml
#
# 3. Seal the secret:
#    kubeseal -o yaml < /tmp/secret.yaml > bootstrap-sealed-secrets.yaml
#
# 4. Commit sealed secret to git (safe to commit!)
#    git add bootstrap-sealed-secrets.yaml
#    git commit -m "feat: add Infisical bootstrap SealedSecrets"
