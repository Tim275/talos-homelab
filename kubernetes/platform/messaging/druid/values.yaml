# Druid Homelab - Wiremind Helm Chart
# https://github.com/wiremind/wiremind-helm-charts/tree/main/charts/druid

image:
  tag: "30.0.1"

# Embedded PostgreSQL for metadata
postgresql:
  enabled: true
  auth:
    username: druid
    password: druidpass123
    database: druid
  primary:
    persistence:
      storageClass: rook-ceph-block-enterprise
      size: 2Gi

# No ZooKeeper - use K8s extensions
zookeeper:
  enabled: false

# K8s discovery config
configVars:
  druid_zk_service_enabled: "false"
  druid_discovery_type: k8s
  druid_serverview_type: http
  druid_coordinator_loadqueuepeon_type: http
  druid_indexer_runner_type: httpRemote
  druid_storage_type: local
  druid_storage_storageDirectory: /opt/druid/var/druid/segments

# Homelab resources (minimal)
broker:
  replicaCount: 1
  javaOpts: "-Xms256m -Xmx512m -XX:MaxDirectMemorySize=256m"
  resources:
    limits:
      memory: 1Gi
      cpu: 500m

coordinator:
  replicaCount: 1
  javaOpts: "-Xms128m -Xmx256m"
  resources:
    limits:
      memory: 512Mi
      cpu: 500m

overlord:
  replicaCount: 1
  javaOpts: "-Xms128m -Xmx256m"
  resources:
    limits:
      memory: 512Mi
      cpu: 500m

router:
  replicaCount: 1
  javaOpts: "-Xms64m -Xmx128m"
  resources:
    limits:
      memory: 256Mi
      cpu: 250m

historical:
  replicaCount: 1
  javaOpts: "-Xms256m -Xmx512m -XX:MaxDirectMemorySize=256m"
  resources:
    limits:
      memory: 1Gi
      cpu: 500m
  persistence:
    enabled: true
    storageClass: rook-ceph-block-enterprise
    size: 10Gi

middleManager:
  replicaCount: 1
  javaOpts: "-Xms64m -Xmx128m"
  resources:
    limits:
      memory: 256Mi
      cpu: 500m
  persistence:
    enabled: true
    storageClass: rook-ceph-block-enterprise
    size: 5Gi
