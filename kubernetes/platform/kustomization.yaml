# 🎯 PLATFORM 3-LEVEL CONTROL - MAXIMUM FLEXIBILITY!
# ================================================
# Level 1: DOMAIN CONTROL (this file) - Nice-to-have for extreme scenarios
# Level 2: SERVICE CONTROL (ApplicationSet lists) - Main day-to-day control
# Level 3: COMPONENT CONTROL (service/kustomization.yaml) - Fine-grained control
#
# RESULT: Every platform service visible as individual Application in ArgoCD UI!

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      enterprise.tier: platform
      enterprise.pattern: triple-level-control-2025
      team: timour

# 🌊 Sync Wave 15: Platform Layer (After Infrastructure)
commonAnnotations:
  argocd.argoproj.io/sync-wave: "15"

resources:
  # 🏛️ PLATFORM PROJECT
  - project.yaml

  # 🎛️ LEVEL 1: DOMAIN CONTROL - Comment/Uncomment for extreme scenarios
  # ====================================================================

  # 🎯 ENTERPRISE GITILES PATTERN - Pure Kustomize Control
  # ======================================================
  # Comment/Uncomment individual services for TRUE control

  # 💾 DATA SERVICES (Comment/Uncomment individual services)
  # - data/mongodb/                      # ❌ DISABLED via comment
  - data/influxdb/
  - data/cloudbeaver/
  - data/n8n-dev-cnpg/
  - data/n8n-prod-cnpg/
  - data/quantlab-postgres/

  # 📨 MESSAGING SERVICES (Comment/Uncomment individual services)
  - messaging/kafka/
  - messaging/redpanda-console/
  - messaging/schema-registry/

  # 🔐 IDENTITY SERVICES (Comment/Uncomment individual services)
  - identity/lldap/
  - identity/authelia/

  # 👨‍💻 DEVELOPER SERVICES (Comment/Uncomment individual services)
  # - developer/backstage/           # ❌ DISABLED - Helm schema issues

# 🎯 3-LEVEL CONTROL EXAMPLES:
#
# 🔧 NORMAL DAY-TO-DAY USE (Level 2 - Service Control):
# - Want to disable mongodb? → Comment it in data-app.yaml
# - Want to disable backstage? → Comment it in developer-app.yaml
# - Want to disable kafka? → Comment it in messaging-app.yaml
#
# 🛠️ FINE-GRAINED CONTROL (Level 3 - Component Control):
# - Want to disable n8n dev environment? → Comment n8n-dev/ in data/n8n/kustomization.yaml
# - Want to disable kafka ui? → Comment redpanda-console in messaging/kustomization.yaml
#
# 🚨 EXTREME SCENARIOS (Level 1 - Domain Control):
# - Testing: Comment data-app.yaml → ALL data services disabled
# - Migration: Comment messaging-app.yaml → ALL messaging services disabled
# - Debugging: Comment identity-app.yaml → ALL identity services disabled
