apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# üöÄ 2025 ENTERPRISE HYBRID - Platform ApplicationSets + Kustomize Control
# ========================================================================
# LEVEL 1: Bootstrap deploys this (App-of-Apps pattern)
# LEVEL 2: This deploys ApplicationSets (for component visibility)
# LEVEL 3: Domain kustomization.yaml files (TRUE kustomize control)
#
# This follows 2025 enterprise best practices:
# - Netflix: Multi-layered GitOps with component discovery
# - Google: Platform engineering with self-service visibility
# - Spotify: Golden Path with team autonomy
# - Meta: Hybrid patterns for scale + control

commonLabels:
  app.kubernetes.io/managed-by: argocd
  enterprise.tier: platform
  enterprise.pattern: hybrid-2025
  team: timour

# üåä Sync Wave 15: Platform Layer (After Infrastructure)
commonAnnotations:
  argocd.argoproj.io/sync-wave: "15"

resources:
  # üéØ PLATFORM LAYER CONTROL - COMMENT/UNCOMMENT = ENABLE/DISABLE!
  # ==============================================================

  # ‚úÖ ENABLED PLATFORM MANAGEMENT
  - project.yaml           # ArgoCD project for platform
  - applications.yaml      # ApplicationSets for component visibility & debugging

  # üéØ DOMAIN KUSTOMIZATION FILES PROVIDE TRUE CONTROL:
  # data/kustomization.yaml - CloudBeaver, InfluxDB, MongoDB, N8N PostgreSQL
  # identity/kustomization.yaml - Authelia, LLDAP OIDC authentication
  # messaging/kustomization.yaml - Kafka, Redpanda Console, Schema Registry
  # developer/kustomization.yaml - Backstage developer platform
  #
  # üí° ApplicationSets discover components, kustomization.yaml controls deployment!

  # ‚ùå DISABLED PLATFORM MANAGEMENT (comment out to disable)
  # - legacy-direct-deployment/  # ‚ùå DISABLED - Using hybrid pattern now