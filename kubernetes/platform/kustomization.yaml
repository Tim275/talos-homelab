# ğŸ¯ ENTERPRISE BOOTSTRAP PATTERN - 2-STEP CONTROL
# ===============================================
# STEP 1: BOOTSTRAP - kubectl apply -k platform/
#         Deploys ONLY Projects + ApplicationSets (no individual services)
#         Fast bootstrap without waiting for Helm charts
#
# STEP 2: GRANULAR CONTROL - Comment/Uncomment in ApplicationSet files
#         Edit data-app.yaml, messaging-app.yaml, identity-app.yaml
#         Individual services ein/ausschalten nach Bootstrap
#
# RESULT: Every platform service visible as individual Application in ArgoCD UI!

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      enterprise.tier: platform
      enterprise.pattern: triple-level-control-2025
      team: timour

# ğŸŒŠ Sync Wave 15: Platform Layer (After Infrastructure)
commonAnnotations:
  argocd.argoproj.io/sync-wave: "15"

resources:
  # ğŸ›ï¸ PLATFORM PROJECT
  - project.yaml

  # ğŸ›ï¸ LEVEL 1: DOMAIN CONTROL - Comment/Uncomment for extreme scenarios
  # ====================================================================

  # ğŸ¯ ENTERPRISE GITILES PATTERN - Pure Kustomize Control
  # ======================================================
  # Comment/Uncomment individual services for TRUE control

  # ğŸ¯ ENTERPRISE BOOTSTRAP - ApplicationSets only (no individual services)
  # Individual services are managed by ApplicationSets after bootstrap

  # ğŸ’¾ DATA ApplicationSet
  - data-app.yaml                      # ApplicationSet for data services

  # ğŸ“¨ MESSAGING ApplicationSet
  - messaging-app.yaml                 # ApplicationSet for messaging services

  # ğŸ” IDENTITY ApplicationSet
  - identity-app.yaml                  # ApplicationSet for identity services

  # ğŸ”¥ CHAOS ENGINEERING - Chaos Mesh for resilience testing
  # - chaos-mesh/application.yaml        # âŒ DISABLED: Not needed for homelab

  # ğŸ‘¨â€ğŸ’» DEVELOPER ApplicationSet
  # - developer-app.yaml               # âŒ TODO: Create developer ApplicationSet

# ğŸ¯ 3-LEVEL CONTROL EXAMPLES:
#
# ğŸ”§ NORMAL DAY-TO-DAY USE (Level 2 - Service Control):
# - Want to disable mongodb? â†’ Comment it in data-app.yaml
# - Want to disable backstage? â†’ Comment it in developer-app.yaml
# - Want to disable kafka? â†’ Comment it in messaging-app.yaml
#
# ğŸ› ï¸ FINE-GRAINED CONTROL (Level 3 - Component Control):
# - Want to disable n8n dev environment? â†’ Comment n8n-dev/ in data/n8n/kustomization.yaml
# - Want to disable kafka ui? â†’ Comment redpanda-console in messaging/kustomization.yaml
#
# ğŸš¨ EXTREME SCENARIOS (Level 1 - Domain Control):
# - Testing: Comment data-app.yaml â†’ ALL data services disabled
# - Migration: Comment messaging-app.yaml â†’ ALL messaging services disabled
# - Debugging: Comment identity-app.yaml â†’ ALL identity services disabled
