# Homelab-specific configuration overrides
# Optimize resource usage for homelab environment

# PostgreSQL cluster sizing for homelab
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: postgresql-cluster
  namespace: postgresql-system
spec:
  # Reduced instances for homelab
  instances: 2  # HA but not enterprise-scale
  
  # Homelab-optimized resources - drastically reduced to prevent crashes
  resources:
    requests:
      memory: "256Mi"  # Reduced from 512Mi
      cpu: "200m"      # Reduced from 300m
    limits:
      memory: "1Gi"    # Reduced from 2Gi to save memory
      cpu: "500m"      # Reduced from 1000m
      
  # Smaller storage for homelab
  storage:
    size: 50Gi
    storageClass: longhorn

---
# MongoDB cluster template for homelab
apiVersion: mongodbcommunity.mongodb.com/v1
kind: MongoDBCommunity
metadata:
  name: mongodb-cluster
  namespace: mongodb-system  
spec:
  members: 2  # Reduced for homelab
  type: ReplicaSet
  version: "7.0.5"
  
  # Homelab resource optimization
  statefulSet:
    spec:
      template:
        spec:
          containers:
          - name: mongod
            resources:
              requests:
                cpu: 100m      # Reduced from 200m
                memory: 256Mi  # Reduced from 512Mi
              limits:
                cpu: 500m      # Reduced from 1000m
                memory: 1Gi    # Reduced from 2Gi to save memory
          - name: mongodb-agent
            resources:
              requests:
                cpu: 100m
                memory: 200Mi
              limits:
                cpu: 500m
                memory: 500Mi
                
  # Storage configuration
  storage:
    size: 30Gi
    storageClassName: longhorn