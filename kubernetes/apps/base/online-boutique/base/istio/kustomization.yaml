apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  # Gateway Configuration
  - gateway.yaml

  # Traffic Management - VirtualServices
  - virtualservice-frontend.yaml
  - virtualservice-checkout.yaml
  # - virtualservice-frontend-canary.yaml  # Canary deployment example (disabled by default)

  # Traffic Management - DestinationRules
  - destinationrule-frontend.yaml  # Includes circuit breaking + canary subsets
  - destinationrule-checkout.yaml
  - destinationrule-cart.yaml

  # Security - mTLS
  - peerauthentication.yaml  # STRICT mTLS enforcement

  # Security - AuthorizationPolicies
  - authorizationpolicy-checkout.yaml  # Frontend → Checkout RBAC
  - authorizationpolicy-cart.yaml      # Frontend + Checkout → Cart RBAC
