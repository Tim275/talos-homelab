apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# ðŸŒŠ Sync Wave 20: Applications (After Platform/Database)
commonAnnotations:
  argocd.argoproj.io/sync-wave: "20"

namespace: n8n-prod

resources:
- ../../../base/n8n
- envoy-httproute.yaml

patches:
- path: resources-patch.yaml
  target:
    kind: Deployment
    name: n8n
- path: backup-patch.yaml
  target:
    kind: Deployment
    name: n8n
- path: configmap-patch.yaml
  target:
    kind: ConfigMap
    name: n8n-configmap

labels:
  - pairs:
      environment: production
    includeSelectors: false  # Don't modify immutable selectors

images:
- name: docker.n8n.io/n8nio/n8n
  newTag: "1.78.0"  # Production uses pinned stable version