apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  # Step 1: Create kubernetes realm with OIDC clients (ArgoCD, kubectl, future: Grafana, Hubble, etc.)
  - realm-setup.yaml

  # Step 2: Enable MFA/OTP (Google Authenticator)
  - mfa-setup.yaml

  # Step 3: RBAC - Grant cluster-admin to cluster-admins group
  - oidc-clusterrolebinding.yaml

  # Step 4: PostgreSQL backup schedule
  - backup-schedule.yaml

  # NOTE: Google OAuth removed per security policy (username/password + TOTP only)
  # NOTE: kubernetes-realm-setup.yaml replaced by argocd-keycloak-setup.yaml (includes ArgoCD client)
