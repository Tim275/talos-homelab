apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# 🌐 NETWORK DOMAIN - TIER-3 COMPONENT CONTROL
# ============================================
# Comment/Uncomment components to enable/disable network stack

commonLabels:
  app.kubernetes.io/managed-by: argocd
  infrastructure.domain: network

# 🌊 Sync Wave 1: Network Foundation Layer
commonAnnotations:
  argocd.argoproj.io/sync-wave: "1"

resources:
  # 🌐 Core Network Infrastructure
  - cilium/              # ✅ CNI + Service Mesh + Load Balancing
  - gateway/             # ✅ Kubernetes Gateway API

  # 🔐 Service Mesh (Istio Ambient) - Ordered Dependencies
  - istio-base/          # ✅ Wave 0: Namespace + Base CRDs
  - sail-operator/       # ✅ Wave 1: Sail Operator (Lifecycle Management)
  - istio-control-plane/ # ✅ Wave 2: Istio CR (after Operator CRDs)
  - istio-cni/           # ✅ Wave 3: CNI
  - istio-gateway/       # ✅ Wave 3: Gateway

  # 🌍 External Connectivity
  - cloudflared/         # ✅ Cloudflare tunnels

  # 🔧 Optional Network Components (Toggle with #)
  # - metallb/           # ❌ DISABLED - Using Cilium LoadBalancer instead
  # - traefik/           # ❌ DISABLED - Using Istio Gateway instead