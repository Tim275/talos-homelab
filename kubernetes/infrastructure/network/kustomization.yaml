apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# ğŸ¢ TIER-0 ENTERPRISE PATTERN: Layer-based Infrastructure
# Netflix/Google/Meta/Amazon Pattern: Declarative resource composition
namespace: argocd

# ğŸŒŠ Sync Wave 1: Network Foundation Layer
commonAnnotations:
  argocd.argoproj.io/sync-wave: "1"

commonLabels:
  app.kubernetes.io/managed-by: argocd
  infrastructure.layer: network
  enterprise.tier: platform

# ğŸ¢ ENTERPRISE PATTERN: Kustomize-based resource composition (not ApplicationSets)
resources:
  - project.yaml

  # ğŸŒ Wave 0: Core Network Infrastructure
  - cilium
  - gateway

  # ğŸ” Wave 1: Service Mesh (Istio Ambient) - Unified Application
  - istio-app.yaml

  # ğŸŒ Wave 2: External Connectivity
  - cloudflared