apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# ğŸŒ NETWORK DOMAIN - TIER-3 COMPONENT CONTROL
# ============================================
# Comment/Uncomment components to enable/disable network stack

commonLabels:
  app.kubernetes.io/managed-by: argocd
  infrastructure.domain: network

# ğŸŒŠ Sync Wave 1: Network Foundation Layer
commonAnnotations:
  argocd.argoproj.io/sync-wave: "1"

resources:
  # ğŸŒ Core Network Infrastructure
  - cilium/              # âœ… CNI + Service Mesh + Load Balancing
  - gateway/             # âœ… Kubernetes Gateway API

  # ğŸ” Service Mesh (Istio Ambient) - Modern 2025 Sail Operator Pattern
  # - istio-base/        # âŒ DISABLED - Replaced by sail-operator (modern approach)
  - sail-operator/       # âœ… Wave 1: Sail Operator (Lifecycle Management + Base CRDs)
  - istio-control-plane/ # âœ… Wave 2: Istio CR (after Operator CRDs)
  - istio-cni/           # âœ… Wave 3: CNI
  - istio-gateway/       # âœ… Wave 3: Gateway

  # ğŸŒ External Connectivity
  - cloudflared/         # âœ… Cloudflare tunnels

  # ğŸ”§ Optional Network Components (Toggle with #)
  # - metallb/           # âŒ DISABLED - Using Cilium LoadBalancer instead
  # - traefik/           # âŒ DISABLED - Using Istio Gateway instead