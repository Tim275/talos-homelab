apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# 🏢 TIER-0 ENTERPRISE PATTERN: Layer-based Infrastructure
# Netflix/Google/Meta/Amazon Pattern: Declarative resource composition
namespace: argocd

# 🌊 Sync Wave 1: Network Foundation Layer
commonAnnotations:
  argocd.argoproj.io/sync-wave: "1"

commonLabels:
  app.kubernetes.io/managed-by: argocd
  infrastructure.layer: network
  enterprise.tier: platform

# 🏢 ENTERPRISE PATTERN: Kustomize-based resource composition (not ApplicationSets)
resources:
  - project.yaml

  # 🌐 Wave 0: Core Network Infrastructure
  - cilium
  - gateway

  # 🔐 Wave 1: Service Mesh (Istio Ambient) - Unified Application
  - istio-app.yaml

  # 🌍 Wave 2: External Connectivity
  - cloudflared