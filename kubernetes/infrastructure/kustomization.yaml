apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# üöÄ 2025 ENTERPRISE HYBRID - App-of-Apps + ApplicationSets + Kustomize
# =====================================================================
# LEVEL 1: Bootstrap deploys this (App-of-Apps pattern)
# LEVEL 2: This deploys ApplicationSets (for component visibility)
# LEVEL 3: Domain kustomization.yaml files (TRUE kustomize control)
#
# This follows 2025 enterprise best practices:
# - Netflix: Multi-layered GitOps with component discovery
# - Google: Platform engineering with self-service visibility
# - Spotify: Golden Path with team autonomy
# - Meta: Hybrid patterns for scale + control

commonLabels:
  app.kubernetes.io/managed-by: argocd
  enterprise.tier: infrastructure
  enterprise.pattern: hybrid-2025
  team: timour

# üåä Sync Wave 1: Infrastructure Foundation Layer
commonAnnotations:
  argocd.argoproj.io/sync-wave: "1"

resources:
  # üéØ INFRASTRUCTURE LAYER CONTROL - COMMENT/UNCOMMENT = ENABLE/DISABLE!
  # ====================================================================

  # ‚úÖ ENABLED INFRASTRUCTURE MANAGEMENT
  - project.yaml           # ArgoCD project for infrastructure
  - applications.yaml      # ApplicationSets for component visibility & debugging

  # üéØ DOMAIN KUSTOMIZATION FILES PROVIDE TRUE CONTROL:
  # controllers/kustomization.yaml - ArgoCD, cert-manager, sealed-secrets
  # network/kustomization.yaml - Cilium, Istio, Gateway API, Cloudflared
  # storage/kustomization.yaml - Rook-Ceph, CSI drivers
  # monitoring/kustomization.yaml - Prometheus, Grafana, AlertManager
  # observability/kustomization.yaml - Vector, Elasticsearch, Kibana
  #
  # üí° ApplicationSets discover components, kustomization.yaml controls deployment!

  # ‚ùå DISABLED INFRASTRUCTURE MANAGEMENT (comment out to disable)
  # - legacy-direct-deployment/  # ‚ùå DISABLED - Using hybrid pattern now