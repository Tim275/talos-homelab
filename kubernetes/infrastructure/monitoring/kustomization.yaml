apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# üéØ TRUE KUSTOMIZE CONTROL - COMMENT/UNCOMMENT = ENABLE/DISABLE!
# ===============================================================
# This is what you wanted for 35 hours! Pure kustomize control!

commonLabels:
  app.kubernetes.io/managed-by: argocd
  infrastructure.domain: monitoring

# üåä Sync Wave 5: Monitoring (After Storage)
commonAnnotations:
  argocd.argoproj.io/sync-wave: "5"

resources:
  # üéØ MONITORING COMPONENTS - COMMENT/UNCOMMENT TO CONTROL!
  # =======================================================

  # üèóÔ∏è INFRASTRUCTURE (Wave 0)
  - namespace.yaml               # ‚úÖ Monitoring namespace with privileged PodSecurity
  - cilium-servicemonitors.yaml  # ‚úÖ Cilium & Hubble metrics collection
  - istio-servicemonitors.yaml   # ‚úÖ Istio service mesh metrics collection
  - kafka-servicemonitors.yaml   # ‚úÖ Kafka Strimzi metrics collection
  - n8n-servicemonitors.yaml     # ‚úÖ N8N application & database metrics collection

  # ‚úÖ ENABLED INDIVIDUAL MICROSERVICES (restored beautiful architecture!)
  - grafana-operator/    # ‚úÖ ENABLED - Grafana Operator for CRD management
  - prometheus/          # ‚úÖ ENABLED - Metrics collection
  - grafana/             # ‚úÖ ENABLED - Visualization
  - dashboards/          # ‚úÖ ENABLED - Grafana dashboards
  - jaeger/              # ‚úÖ ENABLED - Distributed tracing
  # - alertmanager/      # ‚ùå DISABLED - Alert routing (enable if needed)
  # - loki/              # ‚ùå DISABLED - Log aggregation (using Elasticsearch)
  - metrics-server/      # ‚úÖ Kubernetes Metrics API

  # ‚ùå DISABLED MONITORING COMPONENTS (comment out to disable)
  # - prometheus/      # ‚ùå DISABLED - Monolithic kube-prometheus-stack
  # - jaeger/          # ‚ùå DISABLED - Not needed yet
  # - opencost/        # ‚ùå DISABLED - Cost optimization not needed yet
  # - hubble/          # ‚ùå DISABLED - Cilium observability not needed yet
