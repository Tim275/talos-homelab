apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# üîç Sync Wave 6: Tempo Distributed Tracing (After Loki)
# PRODUCTION-READY: S3 storage, 30-day retention, multi-protocol receivers
commonAnnotations:
  argocd.argoproj.io/sync-wave: "6"

# ============================================================
# PRODUCTION RESOURCES
# ============================================================
resources:
  - objectbucketclaim.yaml        # Ceph S3 bucket for trace storage
  - s3-credentials.yaml           # Sealed secret with S3 credentials
  - grafana-datasource.yaml       # Grafana datasource with trace correlation

# ============================================================
# NON-PRODUCTION RESOURCES (Commented out for production)
# ============================================================
# Uncomment for testing trace ingestion:
#  - test-trace-generator.yaml.nonprod

helmCharts:
  - name: tempo-distributed
    repo: https://grafana.github.io/helm-charts
    version: "1.52.5" # renovate: helm=grafana/tempo-distributed
    releaseName: tempo
    namespace: monitoring
    valuesFile: values.yaml
