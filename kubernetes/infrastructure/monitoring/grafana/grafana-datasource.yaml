apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDatasource
metadata:
  name: prometheus
  namespace: monitoring
  labels:
    app.kubernetes.io/name: prometheus
    app.kubernetes.io/component: datasource
    app.kubernetes.io/part-of: monitoring-stack
    team: platform
  annotations: {}
spec:
  instanceSelector:
    matchLabels:
      app: grafana  # âœ… Matches our Grafana instance
  valuesFrom:
    - targetPath: "url"
      valueFrom:
        configMapKeyRef:
          name: prometheus-datasource-config
          key: url
  datasource:
    name: Prometheus
    type: prometheus
    access: proxy
    url: http://prometheus-operator-kube-p-prometheus.monitoring.svc.cluster.local:9090
    basicAuth: false
    isDefault: true
    editable: false
    jsonData:
      httpMethod: POST
      timeInterval: "30s"
