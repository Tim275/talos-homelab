apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization


# Cache-bust comment to force fresh ArgoCD repo download: $(date +%s)
resources:
  - ns.yaml
  - grafana.yaml
  # - grafana-operator-dashboard.yaml      # ‚ùå DISABLED: File doesn't exist
  - http-route.yaml                        # ‚úÖ ENABLED: HTTPS access via Envoy Gateway (Port 443)
  - http-route-http.yaml                   # ‚úÖ ENABLED: HTTP access for Cloudflare Tunnel (Port 80)
  # - admin-credentials.yaml          # ‚ùå DISABLED: SealedSecret decryption failing
  # - oidc-credentials.yaml           # ‚ùå DISABLED: SealedSecret decryption failing
  - datasources/alertmanager-operated.yaml
  - datasources/prometheus-operated.yaml
  - datasources/prometheus-grafanacom.yaml
  - datasources/loki.yaml

  # üìä DASHBOARDS
  # All dashboards are managed as GrafanaDashboard CRDs deployed by other sources
  # (ArgoCD applications, Helm charts, etc.)
  # No ConfigMap dashboards - Grafana Operator v5 only supports CRDs

# ‚ùå REMOVED: grafana-operator moved to separate infrastructure-grafana-operator application
# This prevents duplicate CRD conflicts with grafana-operator/ directory
# helmCharts:
#   - name: grafana-operator
#     repo: oci://ghcr.io/grafana/helm-charts
#     includeCRDs: true
#     namespace: grafana
#     version: v5.19.1 # renovate: github-releases=grafana/grafana-operator
#     releaseName: grafana-operator
#     valuesFile: ./values.yaml
