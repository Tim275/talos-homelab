apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# 🌊 Sync Wave 6: Grafana CRD Resources (After Grafana Operator Wave 4)
commonAnnotations:
  argocd.argoproj.io/sync-wave: "6"

# 🎯 GRAFANA OPERATOR PATTERN - Only CRD resources, no Helm chart!
# Grafana Operator (deployed separately) manages the Grafana instance
resources:
  - grafana-instance.yaml         # ✅ REQUIRED - GrafanaDatasource needs matching Grafana instance
  - grafana-datasource.yaml       # ✅ CRITICAL - connects Grafana to Prometheus!
  - prometheus-datasource-config.yaml  # ConfigMap for Prometheus URL
  - loki-datasource.yaml          # ✅ CRITICAL - connects Grafana to Loki!
  # 📊 ConfigMap Dashboards - keep your preferred dashboard pattern
  # (These work with both Helm Grafana and Grafana Operator)
  - datasources.yaml              # Prometheus connection configuration
  - dashboards-configmap.yaml     # Complete dashboard JSON files as Infrastructure as Code
  - dashboards/                   # Folder with specialized dashboard collections

  # 🎯 NATIVE GRAFANA OPERATOR DASHBOARDS - ConfigMap References
  # Links traditional ConfigMaps to GrafanaDashboard CRDs (Vegarn pattern)
  - configmap-dashboards/         # GrafanaDashboard CRDs with ConfigMap references

  # 🎯 GRAFANA OPERATOR DASHBOARDS - Native GrafanaDashboard CRDs
  # Enterprise-grade monitoring dashboards using Grafana Operator
  - operator-dashboards/          # Native GrafanaDashboard CRDs for all infrastructure components

# ❌ REMOVED: Helm chart - replaced by Grafana Operator CRD
# helmCharts:
#   - name: grafana
#     repo: https://grafana.github.io/helm-charts
