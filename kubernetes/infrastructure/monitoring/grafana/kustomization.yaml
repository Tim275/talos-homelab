apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization


# Cache-bust comment to force fresh ArgoCD repo download: $(date +%s)
resources:
  - ns.yaml
  - grafana.yaml
  # - grafana-operator-dashboard.yaml      # ‚ùå DISABLED: File doesn't exist
  - http-route.yaml                        # ‚úÖ ENABLED: HTTPS access via Envoy Gateway (Port 443)
  - http-route-http.yaml                   # ‚úÖ ENABLED: HTTP access for Cloudflare Tunnel (Port 80)
  # - admin-credentials.yaml          # ‚ùå DISABLED: SealedSecret decryption failing
  # - oidc-credentials.yaml           # ‚ùå DISABLED: SealedSecret decryption failing
  - datasources/alertmanager-operated.yaml
  - datasources/prometheus-operated.yaml
  - datasources/prometheus-grafanacom.yaml
  - datasources/loki.yaml

  # üìä TIER 0 EXECUTIVE DASHBOARDS - Enterprise SRE Overview
  - enterprise-dashboards/tier0-executive/k8s-global-view.yaml
  - enterprise-dashboards/tier0-executive/prometheus-targets-health.yaml
  - enterprise-dashboards/tier0-executive/cert-manager-status.yaml
  - enterprise-dashboards/tier0-executive/node-system-overview.yaml

  # üìä KUBERNETES CORE COMPONENTS - Control Plane & System Monitoring
  - enterprise-dashboards/kubernetes/k8s-api-server.yaml                # ‚úÖ Official Grafana.com dashboard (ID: 15761)
  - enterprise-dashboards/kubernetes/k8s-coredns.yaml                   # ‚úÖ Official Grafana.com dashboard (ID: 15762)
  - enterprise-dashboards/kubernetes/k8s-views-global.yaml              # ‚úÖ Official Grafana.com dashboard (ID: 15757)
  - enterprise-dashboards/kubernetes/k8s-views-namespaces.yaml          # ‚úÖ Official Grafana.com dashboard (ID: 15758)
  - enterprise-dashboards/kubernetes/k8s-views-nodes.yaml               # ‚úÖ Official Grafana.com dashboard (ID: 15759)
  - enterprise-dashboards/kubernetes/k8s-views-pods.yaml                # ‚úÖ Official Grafana.com dashboard (ID: 15760)
  - enterprise-dashboards/kubernetes/k8s-scheduler.yaml                 # ‚úÖ Official Grafana.com dashboard (ID: 12130)
  - enterprise-dashboards/kubernetes/k8s-controller-manager.yaml        # ‚úÖ Official Grafana.com dashboard (ID: 12122)
  - enterprise-dashboards/kubernetes/k8s-etcd.yaml                      # ‚úÖ Official Grafana.com dashboard (ID: 20330)

  # üìä TIER 1 INFRASTRUCTURE DASHBOARDS - Storage & Databases
  - enterprise-dashboards/tier1-infrastructure/rook-ceph-storage.yaml
  - enterprise-dashboards/tier1-infrastructure/postgresql-cnpg.yaml
  - enterprise-dashboards/tier1-infrastructure/redis-clusters.yaml
  - enterprise-dashboards/tier1-infrastructure/official-cert-manager.yaml    # ‚úÖ Official Grafana.com dashboard (ID: 20842)
  - enterprise-dashboards/tier1-infrastructure/official-ceph-cluster.yaml     # ‚úÖ Official Grafana.com dashboard (ID: 2842)
  - enterprise-dashboards/tier1-infrastructure/official-ceph-pools.yaml       # ‚úÖ Official Grafana.com dashboard (ID: 5342)
  - enterprise-dashboards/tier1-infrastructure/official-ceph-osd.yaml         # ‚úÖ Official Grafana.com dashboard (ID: 5336)
  # - enterprise-dashboards/tier1-infrastructure/official-cloudnativepg.yaml  # ‚ùå DISABLED: Too large (>262KB annotations limit)
  - enterprise-dashboards/tier1-infrastructure/official-redis-operator.yaml   # ‚úÖ Official Grafana.com dashboard (ID: 12165)
  - enterprise-dashboards/tier1-infrastructure/official-influxdb-metrics.yaml # ‚úÖ Official Grafana.com dashboard (ID: 13315)
  - enterprise-dashboards/tier1-infrastructure/official-velero-stats.yaml     # ‚úÖ Official Grafana.com dashboard (ID: 11055)
  - enterprise-dashboards/tier1-infrastructure/official-velero-exporter.yaml  # ‚úÖ Official Grafana.com dashboard (ID: 15469)

  # üìä TIER 2 PLATFORM DASHBOARDS - Observability & Messaging
  - enterprise-dashboards/tier2-platform/elasticsearch-cluster.yaml
  - enterprise-dashboards/tier2-platform/kafka-strimzi.yaml
  - enterprise-dashboards/tier2-platform/loki-logging.yaml
  - enterprise-dashboards/tier2-platform/official-kafka-exporter.yaml        # ‚úÖ Official Grafana.com dashboard (ID: 7589)
  - enterprise-dashboards/tier2-platform/official-kafka-cluster.yaml         # ‚úÖ Official Grafana.com dashboard (ID: 14505)
  - enterprise-dashboards/tier2-platform/official-kafka-topics.yaml          # ‚úÖ Official Grafana.com dashboard (ID: 14506)
  - enterprise-dashboards/tier2-platform/official-loki-stack.yaml            # ‚úÖ Official Grafana.com dashboard (ID: 14055)
  - enterprise-dashboards/tier2-platform/official-loki-dashboard.yaml        # ‚úÖ Official Grafana.com dashboard (ID: 13186)
  - enterprise-dashboards/tier2-platform/official-loki-logs.yaml             # ‚úÖ Official Grafana.com dashboard (ID: 15324)
  # - enterprise-dashboards/tier2-platform/official-loki-metrics.yaml        # ‚ùå DISABLED: Too large (>262KB annotations limit)
  - enterprise-dashboards/tier2-platform/official-loki-logging.yaml          # ‚úÖ Official Grafana.com dashboard (ID: 12611)
  - enterprise-dashboards/tier2-platform/official-elasticsearch-overview.yaml # ‚úÖ Official Grafana.com dashboard (ID: 14191)
  - enterprise-dashboards/tier2-platform/official-elasticsearch-xpack.yaml   # ‚úÖ Official Grafana.com dashboard (ID: 8642)
  - enterprise-dashboards/tier2-platform/official-kibana-monitoring.yaml     # ‚úÖ Official Grafana.com dashboard (ID: 21420)
  - enterprise-dashboards/tier2-platform/official-istio-mesh.yaml            # ‚úÖ Official Grafana.com dashboard (ID: 7639)
  - enterprise-dashboards/tier2-platform/official-istio-service.yaml         # ‚úÖ Official Grafana.com dashboard (ID: 7636)
  - enterprise-dashboards/tier2-platform/official-istio-control-plane.yaml   # ‚úÖ Official Grafana.com dashboard (ID: 7645)
  - enterprise-dashboards/tier2-platform/official-istio-performance.yaml     # ‚úÖ Official Grafana.com dashboard (ID: 11829)
  - enterprise-dashboards/tier2-platform/official-istio-workload.yaml        # ‚úÖ Official Grafana.com dashboard (ID: 7630)
  - enterprise-dashboards/tier2-platform/official-envoy-proxy.yaml           # ‚úÖ Official Grafana.com dashboard (ID: 6693)
  - enterprise-dashboards/tier2-platform/official-envoy-global.yaml          # ‚úÖ Official Grafana.com dashboard (ID: 11022)
  - enterprise-dashboards/tier2-platform/official-opentelemetry-collector.yaml  # ‚úÖ Official Grafana.com dashboard (ID: 15983)
  - enterprise-dashboards/tier2-platform/official-opentelemetry-dataflow.yaml   # ‚úÖ Official Grafana.com dashboard (ID: 18309)
  # - enterprise-dashboards/tier2-platform/vector-aggregation.yaml  # ‚ùå DISABLED: No vector_* metrics

  # üìä TIER 3 GITOPS DASHBOARDS - GitOps Deployment
  - enterprise-dashboards/tier3-gitops/argocd-gitops.yaml
  - enterprise-dashboards/tier3-gitops/official-argocd-operational.yaml      # ‚úÖ Official Grafana.com dashboard (ID: 19993)
  - enterprise-dashboards/tier3-gitops/official-argocd-application.yaml      # ‚úÖ Official Grafana.com dashboard (ID: 19974)
  - enterprise-dashboards/tier3-gitops/official-argocd-notifications.yaml    # ‚úÖ Official Grafana.com dashboard (ID: 19975)
  - enterprise-dashboards/tier3-gitops/official-argocd-overview-v3.yaml      # ‚úÖ Official Grafana.com dashboard (ID: 24192)
  - enterprise-dashboards/tier3-gitops/official-argocd-basic.yaml            # ‚úÖ Official Grafana.com dashboard (ID: 14584)
  # - enterprise-dashboards/tier3-gitops/istio-service-mesh.yaml      # ‚ùå DISABLED: Istio metrics not enabled
  # - enterprise-dashboards/tier3-gitops/cilium-networking.yaml       # ‚ùå DISABLED: No cilium_* metrics
  # - enterprise-dashboards/tier3-gitops/jaeger-tracing.yaml          # ‚ùå DISABLED: No metrics exporter

# ‚ùå REMOVED: grafana-operator moved to separate infrastructure-grafana-operator application
# This prevents duplicate CRD conflicts with grafana-operator/ directory
# helmCharts:
#   - name: grafana-operator
#     repo: oci://ghcr.io/grafana/helm-charts
#     includeCRDs: true
#     namespace: grafana
#     version: v5.19.1 # renovate: github-releases=grafana/grafana-operator
#     releaseName: grafana-operator
#     valuesFile: ./values.yaml
