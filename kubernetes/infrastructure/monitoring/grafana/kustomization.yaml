apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization


# Cache-bust comment to force fresh ArgoCD repo download: $(date +%s)
resources:
  - ns.yaml
  - grafana.yaml
  # - grafana-operator-dashboard.yaml      # ‚ùå DISABLED: File doesn't exist
  - http-route.yaml                        # ‚úÖ ENABLED: HTTPS access via Envoy Gateway (Port 443)
  - http-route-http.yaml                   # ‚úÖ ENABLED: HTTP access for Cloudflare Tunnel (Port 80)
  # - admin-credentials.yaml          # ‚ùå DISABLED: SealedSecret decryption failing
  # - oidc-credentials.yaml           # ‚ùå DISABLED: SealedSecret decryption failing
  - datasources/alertmanager-operated.yaml
  - datasources/prometheus-operated.yaml
  - datasources/prometheus-grafanacom.yaml
  - datasources/loki.yaml

  # üìä TIER 0 EXECUTIVE DASHBOARDS - Enterprise SRE Overview
  - enterprise-dashboards/tier0-executive/k8s-global-view.yaml
  - enterprise-dashboards/tier0-executive/prometheus-targets-health.yaml
  - enterprise-dashboards/tier0-executive/cert-manager-status.yaml
  - enterprise-dashboards/tier0-executive/node-system-overview.yaml

  # üìä TIER 1 INFRASTRUCTURE DASHBOARDS - Storage & Databases
  - enterprise-dashboards/tier1-infrastructure/rook-ceph-storage.yaml
  - enterprise-dashboards/tier1-infrastructure/postgresql-cnpg.yaml
  - enterprise-dashboards/tier1-infrastructure/redis-clusters.yaml
  - enterprise-dashboards/tier1-infrastructure/velero-backup.yaml

  # üìä TIER 2 PLATFORM DASHBOARDS - Observability & Messaging
  - enterprise-dashboards/tier2-platform/elasticsearch-cluster.yaml
  - enterprise-dashboards/tier2-platform/kafka-strimzi.yaml
  - enterprise-dashboards/tier2-platform/loki-logging.yaml
  - enterprise-dashboards/tier2-platform/vector-aggregation.yaml

  # üìä TIER 3 GITOPS & SERVICE MESH DASHBOARDS - Networking & Deployment
  - enterprise-dashboards/tier3-gitops/argocd-gitops.yaml
  - enterprise-dashboards/tier3-gitops/istio-service-mesh.yaml
  - enterprise-dashboards/tier3-gitops/cilium-networking.yaml
  - enterprise-dashboards/tier3-gitops/jaeger-tracing.yaml

# ‚ùå REMOVED: grafana-operator moved to separate infrastructure-grafana-operator application
# This prevents duplicate CRD conflicts with grafana-operator/ directory
# helmCharts:
#   - name: grafana-operator
#     repo: oci://ghcr.io/grafana/helm-charts
#     includeCRDs: true
#     namespace: grafana
#     version: v5.19.1 # renovate: github-releases=grafana/grafana-operator
#     releaseName: grafana-operator
#     valuesFile: ./values.yaml
