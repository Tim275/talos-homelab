apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# CSI SNAPSHOT INFRASTRUCTURE - CLUSTER-WIDE
# ===========================================
# VolumeSnapshot CRDs + Snapshot-Controller for ALL CSI drivers
# Works with: Rook Ceph RBD, Rook Ceph CephFS, Proxmox CSI, ZFS, Longhorn, etc.
# Reference: https://github.com/kubernetes-csi/external-snapshotter/tree/master/deploy/kubernetes

namespace: kube-system

resources:
  # VOLUME SNAPSHOT CRDs (v8.2.0)
  # Cluster-wide API definitions for snapshots
  - https://raw.githubusercontent.com/kubernetes-csi/external-snapshotter/v8.2.0/client/config/crd/snapshot.storage.k8s.io_volumesnapshotclasses.yaml
  - https://raw.githubusercontent.com/kubernetes-csi/external-snapshotter/v8.2.0/client/config/crd/snapshot.storage.k8s.io_volumesnapshotcontents.yaml
  - https://raw.githubusercontent.com/kubernetes-csi/external-snapshotter/v8.2.0/client/config/crd/snapshot.storage.k8s.io_volumesnapshots.yaml

  # SNAPSHOT CONTROLLER (v8.2.1)
  # Cluster-wide controller for all CSI drivers
  - https://raw.githubusercontent.com/kubernetes-csi/external-snapshotter/v8.2.1/deploy/kubernetes/snapshot-controller/rbac-snapshot-controller.yaml
  - https://raw.githubusercontent.com/kubernetes-csi/external-snapshotter/v8.2.1/deploy/kubernetes/snapshot-controller/setup-snapshot-controller.yaml

  # ROOK CEPH SNAPSHOT CLASSES
  # StorageClass-specific snapshot configurations
  - rook-ceph-block-snapclass.yaml
  - rook-ceph-fs-snapclass.yaml
