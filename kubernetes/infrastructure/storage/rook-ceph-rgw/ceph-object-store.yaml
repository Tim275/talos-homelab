apiVersion: ceph.rook.io/v1
kind: CephObjectStore
metadata:
  name: homelab-objectstore
  namespace: rook-ceph
spec:
  metadataPool:
    replicated:
      size: 3
  dataPool:
    replicated:
      size: 3
  preservePoolsOnDelete: false
  gateway:
    port: 80
    securePort: 443
    # TLS configuration for HTTPS
    sslCertificateRef: ceph-rgw-tls-secret
    # Homelab: Single instance (HA not needed, saves 1GB+ RAM)
    instances: 1
    # NO LIMITS, only requests
    resources:
      requests:
        cpu: "250m"        # Homelab: reduced from 500m
        memory: "1Gi"      # Homelab: reduced from 2.5GB (sufficient for S3 backups)

  healthCheck:
    readinessProbe:
      probe:
        timeoutSeconds: 10
        periodSeconds: 15
        failureThreshold: 5
    startupProbe:
      probe:
        timeoutSeconds: 10
        periodSeconds: 10
        failureThreshold: 30

  zone:
    name: "homelab"
