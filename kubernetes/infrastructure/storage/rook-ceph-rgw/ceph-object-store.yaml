apiVersion: ceph.rook.io/v1
kind: CephObjectStore
metadata:
  name: homelab-objectstore
  namespace: rook-ceph
spec:
  metadataPool:
    replicated:
      size: 3
  dataPool:
    replicated:
      size: 3
  preservePoolsOnDelete: false
  gateway:
    port: 80
    securePort: 443
    # TLS configuration for HTTPS
    sslCertificateRef: ceph-rgw-tls-secret
    # Enterprise HA: 2 instances for high availability and load balancing
    instances: 2
    resources:
      limits:
        cpu: "1500m"
        memory: "1.5Gi"  # Reduced from 2Gi to save memory
      requests:
        cpu: "500m"
        memory: "512Mi"

  # ðŸ”§ FIX: Explicit zone configuration for proper RGW metadata persistence
  # Without this, bucket metadata is not persisted correctly
  zone:
    name: "homelab"
