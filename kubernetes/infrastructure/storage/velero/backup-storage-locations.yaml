---
# Velero BackupStorageLocation: Cluster Resources
# Stores Kubernetes manifests, ConfigMaps, Secrets, etc.
apiVersion: velero.io/v1
kind: BackupStorageLocation
metadata:
  name: cluster-backups
  namespace: velero
spec:
  provider: aws
  default: true  # Default BSL for cluster resources
  objectStorage:
    bucket: velero-cluster-backups
    # prefix: cluster  # Disabled - Ceph RGW requires prefix to exist first
  config:
    region: us-east-1
    s3ForcePathStyle: "true"
    s3Url: http://rook-ceph-rgw-homelab-objectstore.rook-ceph.svc:80
    insecureSkipTLSVerify: "true"
  credential:
    name: velero-s3-credentials-cluster
    key: cloud

---
# Velero BackupStorageLocation: PersistentVolume Backups
# Stores Restic/Kopia volume snapshots
apiVersion: velero.io/v1
kind: BackupStorageLocation
metadata:
  name: pv-backups
  namespace: velero
spec:
  provider: aws
  default: false  # Not default - used explicitly for PV backups
  objectStorage:
    bucket: velero-pv-backups
    # prefix: volumes  # Disabled - Ceph RGW requires prefix to exist first
  config:
    region: us-east-1
    s3ForcePathStyle: "true"
    s3Url: http://rook-ceph-rgw-homelab-objectstore.rook-ceph.svc:80
    insecureSkipTLSVerify: "true"
  credential:
    name: velero-s3-credentials-pv
    key: cloud
