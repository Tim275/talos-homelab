# OPTIONAL: AWS S3 OFFSITE BACKUP SCHEDULES (TIER-0 ONLY)
# ACTIVATION STEPS:
# 1. Create AWS S3 bucket: timour-homelab-velero-dr
# 2. Create IAM user with S3 access policy
# 3. Add AWS credentials to velero/sealed-secret-aws.yaml
# 4. Uncomment AWS BackupStorageLocation in velero/kustomization.yaml
# 5. Uncomment all schedules below
# 6. kubectl apply -f infrastructure/storage/velero-schedules/
#
# BACKUP STRATEGY:
# - Tier-0 namespaces ONLY (critical data)
# - Daily backups to AWS S3 (1x per day, offsite DR)
# - Ceph RGW backups continue 6-hourly (fast local restore)
# - AWS is for disaster recovery (datacenter failure, fire, etc.)
# - Cost: EUR 0.50/month for ~50GB (Glacier Instant Retrieval)
#
# ---
# apiVersion: velero.io/v1
# kind: Schedule
# metadata:
#   name: tier0-aws-n8n-prod
#   namespace: velero
#   labels:
#     backup-tier: tier-0
#     backup-target: aws-s3-offsite
#     app: n8n-prod
# spec:
#   schedule: "0 4 * * *"  # Daily at 4 AM (off-peak hours)
#   template:
#     includedNamespaces:
#       - n8n-prod
#     storageLocation: aws-s3-offsite
#     ttl: 8760h  # 365 days retention (1 year)
#     defaultVolumesToFsBackup: true  # Restic client-side encryption
#     metadata:
#       labels:
#         backup-tier: tier-0
#         backup-target: aws-s3-offsite
#         namespace: n8n-prod
# ---
# apiVersion: velero.io/v1
# kind: Schedule
# metadata:
#   name: tier0-aws-keycloak
#   namespace: velero
#   labels:
#     backup-tier: tier-0
#     backup-target: aws-s3-offsite
#     app: keycloak
# spec:
#   schedule: "0 4 * * *"
#   template:
#     includedNamespaces:
#       - keycloak
#     storageLocation: aws-s3-offsite
#     ttl: 8760h  # 365 days retention (1 year)
#     defaultVolumesToFsBackup: true
#     metadata:
#       labels:
#         backup-tier: tier-0
#         backup-target: aws-s3-offsite
#         namespace: keycloak
# ---
# apiVersion: velero.io/v1
# kind: Schedule
# metadata:
#   name: tier0-aws-infisical
#   namespace: velero
#   labels:
#     backup-tier: tier-0
#     backup-target: aws-s3-offsite
#     app: infisical
# spec:
#   schedule: "0 4 * * *"
#   template:
#     includedNamespaces:
#       - infisical
#     storageLocation: aws-s3-offsite
#     ttl: 8760h  # 365 days retention (1 year)
#     defaultVolumesToFsBackup: true
#     metadata:
#       labels:
#         backup-tier: tier-0
#         backup-target: aws-s3-offsite
#         namespace: infisical
# ---
# apiVersion: velero.io/v1
# kind: Schedule
# metadata:
#   name: tier0-aws-authelia
#   namespace: velero
#   labels:
#     backup-tier: tier-0
#     backup-target: aws-s3-offsite
#     app: authelia
# spec:
#   schedule: "0 4 * * *"
#   template:
#     includedNamespaces:
#       - authelia
#     storageLocation: aws-s3-offsite
#     ttl: 8760h  # 365 days retention (1 year)
#     defaultVolumesToFsBackup: true
#     metadata:
#       labels:
#         backup-tier: tier-0
#         backup-target: aws-s3-offsite
#         namespace: authelia
# ---
# apiVersion: velero.io/v1
# kind: Schedule
# metadata:
#   name: tier0-aws-lldap
#   namespace: velero
#   labels:
#     backup-tier: tier-0
#     backup-target: aws-s3-offsite
#     app: lldap
# spec:
#   schedule: "0 4 * * *"
#   template:
#     includedNamespaces:
#       - lldap
#     storageLocation: aws-s3-offsite
#     ttl: 8760h  # 365 days retention (1 year)
#     defaultVolumesToFsBackup: true
#     metadata:
#       labels:
#         backup-tier: tier-0
#         backup-target: aws-s3-offsite
#         namespace: lldap
