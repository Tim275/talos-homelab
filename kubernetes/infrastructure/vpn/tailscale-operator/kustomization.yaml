apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# 🔐 TAILSCALE OPERATOR PATTERN - Helm via Kustomize (like Grafana/Sail)
commonAnnotations:
  argocd.argoproj.io/sync-wave: "3"  # After cert-manager, sealed-secrets

namespace: tailscale

# 🏢 Enterprise Service Ownership
labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      app.kubernetes.io/part-of: vpn-infrastructure
      app.kubernetes.io/component: tailscale-operator
      team: platform
      service-tier: infrastructure

# 🎯 Tailscale Operator Helm Chart (via Kustomize)
helmCharts:
  - name: tailscale-operator
    repo: https://pkgs.tailscale.com/helmcharts
    version: 1.88.3
    releaseName: tailscale-operator
    namespace: tailscale
    includeCRDs: true
    valuesFile: values.yaml

# 🔐 OAuth Secret + Connector CRD
resources:
  - oauth-sealed.yaml
  - connector.yaml
