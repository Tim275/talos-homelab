apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# ðŸŒŠ Sync Wave 3: Sealed Secrets Controller (After Certificate Management)
commonAnnotations:
  argocd.argoproj.io/sync-wave: "3"

resources:
  - ns.yaml
  - application.yaml           # âœ… Child Application for App-of-Apps pattern

# âœ… AUTOMATIC: TLS secret created by Terraform module automatically!
# Secret name: sealed-secrets-bootstrap-key (created by tofu/bootstrap/sealed-secrets)
# Uses persistent keys from: tofu/bootstrap/sealed-secrets/certificate/
# No manual steps needed - everything automated via Terraform! ðŸš€

helmCharts:
  - name: sealed-secrets
    repo: https://bitnami-labs.github.io/sealed-secrets
    version: 2.15.4
    releaseName: sealed-secrets-controller
    namespace: sealed-secrets
    includeCRDs: true
    valuesFile: values.yaml