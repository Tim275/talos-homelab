apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# üöÄ 2025 ENTERPRISE HYBRID - App-of-Apps + ApplicationSets + Kustomize
# =====================================================================
# LEVEL 1: Bootstrap deploys this (App-of-Apps pattern)
# LEVEL 2: This deploys ApplicationSets (for component visibility)
# LEVEL 3: Domain kustomization.yaml files (TRUE kustomize control)
#
# This follows 2025 enterprise best practices:
# - Netflix: Multi-layered GitOps with component discovery
# - Google: Platform engineering with self-service visibility
# - Spotify: Golden Path with team autonomy
# - Meta: Hybrid patterns for scale + control

commonLabels:
  app.kubernetes.io/managed-by: argocd
  enterprise.tier: infrastructure
  enterprise.pattern: hybrid-2025
  team: timour

# üåä Sync Wave 1: Infrastructure Foundation Layer
commonAnnotations:
  argocd.argoproj.io/sync-wave: "1"

resources:
  # üéØ INFRASTRUCTURE LAYER CONTROL - COMMENT/UNCOMMENT = ENABLE/DISABLE!
  # ====================================================================

  # ‚úÖ ENABLED INFRASTRUCTURE MANAGEMENT
  - project.yaml           # Infrastructure project with proper security + RBAC

  # üéõÔ∏è DOMAIN APPLICATION SETS - COMMENT/UNCOMMENT TO CONTROL ENTIRE DOMAINS!
  - controllers-app.yaml   # ‚úÖ Controllers (ArgoCD, Cert-Manager, Sealed Secrets)
  - network-app.yaml       # ‚úÖ Network (Cilium, Gateway, CloudFlare)
  - storage-app.yaml       # ‚úÖ Storage (Rook-Ceph, Proxmox CSI)
  - monitoring-app.yaml    # ‚úÖ Monitoring (Prometheus, Grafana, AlertManager, Loki)
  - observability-app.yaml # ‚úÖ ENABLED - Observability (Vector, Elasticsearch, Kibana)

  # üéØ DUAL-LEVEL CONTROL:
  # Level 1: Comment/uncomment domain ApplicationSets above (entire domains)
  # Level 2: Comment/uncomment components in domain/kustomization.yaml files
  #
  # EXAMPLE: Disable Istio CNI but keep rest of network:
  # 1. Keep network-app.yaml enabled above
  # 2. Comment istio-cni in network/kustomization.yaml
  #
  # üí° REAL kustomize control - no more fake excludes!