apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# ðŸŒŠ Production Environment
commonAnnotations:
  argocd.argoproj.io/sync-wave: "20"

namespace: n8n-prod

resources:
- ../base
- patches/envoy-httproute.yaml

patches:
- path: patches/resources-patch.yaml
  target:
    kind: Deployment
    name: n8n
- path: patches/backup-patch.yaml
  target:
    kind: Deployment
    name: n8n
- path: patches/configmap-patch.yaml
  target:
    kind: ConfigMap
    name: n8n-configmap

labels:
  - pairs:
      environment: production
      service: n8n
    includeSelectors: false  # Don't modify immutable selectors

images:
- name: docker.n8n.io/n8nio/n8n
  newTag: "1.78.0"  # Production uses pinned stable version