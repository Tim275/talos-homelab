apiVersion: v1
kind: ConfigMap
metadata:
  name: elasticsearch-cluster-dashboard
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
    app.kubernetes.io/component: monitoring-dashboards
    app.kubernetes.io/part-of: monitoring-stack
data:
  elasticsearch-cluster.json: |
    {
      "dashboard": {
        "id": 4358,
        "title": "Elasticsearch Cluster",
        "tags": ["elasticsearch", "search", "logging"],
        "style": "dark",
        "timezone": "browser",
        "panels": [],
        "time": {
          "from": "now-1h",
          "to": "now"
        },
        "timepicker": {},
        "templating": {
          "list": []
        },
        "version": 0
      }
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: elasticsearch-nodes-dashboard
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
    app.kubernetes.io/component: monitoring-dashboards
    app.kubernetes.io/part-of: monitoring-stack
data:
  elasticsearch-nodes.json: |
    {
      "dashboard": {
        "id": 9239,
        "title": "Elasticsearch Nodes",
        "tags": ["elasticsearch", "nodes", "performance"],
        "style": "dark",
        "timezone": "browser",
        "panels": [],
        "time": {
          "from": "now-1h",
          "to": "now"
        },
        "timepicker": {},
        "templating": {
          "list": []
        },
        "version": 0
      }
    }
---
# ServiceMonitor for Elasticsearch metrics
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: elasticsearch-metrics
  namespace: monitoring
  labels:
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/part-of: monitoring-stack
spec:
  selector:
    matchLabels:
      common.k8s.elastic.co/type: elasticsearch
  namespaceSelector:
    matchNames:
    - elastic-system
  endpoints:
  - port: https
    interval: 30s
    scheme: https
    tlsConfig:
      insecureSkipVerify: true
    basicAuth:
      username:
        name: production-cluster-es-elastic-user
        key: elastic
      password:
        name: production-cluster-es-elastic-user
        key: elastic