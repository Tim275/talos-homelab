# Production-ready Loki Configuration  
deploymentMode: SingleBinary

loki:
  # Filesystem storage for homelab
  storage:
    type: filesystem
  
  # Simple schema config for filesystem
  schemaConfig:
    configs:
      - from: 2020-10-24
        store: boltdb-shipper
        object_store: filesystem  
        schema: v11
        index:
          prefix: index_
          period: 24h
  
  # Storage config for filesystem
  storageConfig:
    boltdb_shipper:
      active_index_directory: /data/loki/boltdb-shipper-active
      cache_location: /data/loki/boltdb-shipper-cache
      shared_store: filesystem
    filesystem:
      directory: /data/loki/chunks
  
  # Resource limits for production
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi

  # Retention policy
  compactor:
    retention_enabled: true
    retention_delete_delay: 2h
    retention_delete_worker_count: 150
  
  limits_config:
    retention_period: 168h  # 7 days
    ingestion_rate_mb: 10
    ingestion_burst_size_mb: 20
    max_global_streams_per_user: 10000
    max_query_parallelism: 32

# Persistent storage for production
singleBinary:
  persistence:
    enabled: true
    storageClass: proxmox-csi
    size: 10Gi
  
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi

# Monitoring integration
monitoring:
  serviceMonitor:
    enabled: true
  prometheusRule:
    enabled: true

# Security
rbac:
  pspEnabled: false

# Disable test components for production
test:
  enabled: false

# Gateway disabled (using single binary)
gateway:
  enabled: false

# Distributed components disabled (using single binary)
read:
  enabled: false
write:
  enabled: false
backend:
  enabled: false