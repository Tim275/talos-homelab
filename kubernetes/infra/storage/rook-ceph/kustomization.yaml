apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - https://raw.githubusercontent.com/rook/rook/v1.15.7/deploy/examples/crds.yaml
  - https://raw.githubusercontent.com/rook/rook/v1.15.7/deploy/examples/common.yaml
  - https://raw.githubusercontent.com/rook/rook/v1.15.7/deploy/examples/operator.yaml
  - pool.yaml
  - cluster.yaml
  - storageclass-block.yaml
  - storageclass-filesystem.yaml

# Talos-spezifische Namespace-Label Patch f√ºr das common.yaml namespace
patches:
  - target:
      kind: Namespace
      name: rook-ceph
    patch: |-
      - op: add
        path: /metadata/labels/pod-security.kubernetes.io~1enforce
        value: privileged
      - op: add
        path: /metadata/labels/pod-security.kubernetes.io~1audit
        value: privileged
      - op: add
        path: /metadata/labels/pod-security.kubernetes.io~1warn
        value: privileged